/* Query to retrieve limited vulnerability data */

SELECT ds.summary AS "Solution Summary", proofAsText(ds.fix) AS "Solution Steps", 
da.ip_address AS "IP Addresse", da.host_name AS "Host Name", da.sites AS "Sites", dos.description AS "Operating System",
ds2.name AS "Service Name", fasvi.port AS "Service Port", dv.severity AS "Severity",round(cast(dv.cvss_score as numeric), 1) AS "CVSS Score",
fasvi.date AS "Vulnerable Since", dv.date_published AS "Vuln Published Date", dv.description AS "Vuln Description", proofAsText(fasvi.proof) AS "Proof",
dvr.reference AS "CVE"
FROM fact_remediation(25, 'riskscore DESC') AS fr
JOIN dim_solution AS ds ON fr.solution_id = ds.solution_id
JOIN dim_asset_vulnerability_solution davs ON fr.solution_id = davs.solution_id
JOIN dim_asset AS da ON davs.asset_id = da.asset_id
JOIN dim_operating_system dos ON (dos.operating_system_id = da.operating_system_id)
JOIN dim_vulnerability dv ON (dv.vulnerability_id = davs.vulnerability_id)
JOIN fact_asset_scan_vulnerability_instance fasvi ON (fasvi.vulnerability_id = dv.vulnerability_id AND fasvi.asset_id = da.asset_id)
JOIN dim_service ds2 ON (ds2.service_id = fasvi.service_id)
JOIN dim_asset_service_configuration dasc ON (dasc.service_id = ds2.service_id)
JOIN dim_vulnerability_reference dvr ON (dvr.vulnerability_id = dv.vulnerability_id)
