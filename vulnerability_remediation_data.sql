/* This SQL query displays vulnerability scan data and the
 * corresponding remediation data for each vulnerability.
 * This query only shows 'Severe' level vulnerabilities, but can be alterened to show 
 * 'Critical' and 'Moderate' level vulnerabilities.
 */
 
SELECT dv.vulnerability_id AS "Vuln ID", da.ip_address AS "Asset IP", dv.description AS "Vuln Description", dv.title AS "Vuln Title", 
dv.severity_score AS "Severity Score", dv.severity AS "Vuln Severity", dv.exploits AS "Vuln Expoit Count", 
ds.fix AS "Solution", ds.solution_type AS "Solution Type", ds.estimate AS "Remediation Time Estimate", 
ds.summary AS "Solution Summary"
FROM fact_asset_scan_vulnerability_instance AS favi
JOIN dim_vulnerability dv ON dv.vulnerability_id = favi.vulnerability_id
JOIN dim_asset da ON da.asset_id = favi.asset_id
JOIN dim_asset_vulnerability_solution davs ON davs.asset_id = da.asset_id
JOIN dim_solution ds ON ds.solution_id = davs.solution_id
WHERE dv.severity = 'Severe'

/* Levels: Critical, Severe, Moderate */
